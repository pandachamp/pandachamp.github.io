// JavaScript Document
function closest (num, arr) {
                var curr = arr[0];
                var diff = Math.abs (num - curr);
                for (var val = 0; val < arr.length; val++) {
                    var newdiff = Math.abs (num - arr[val]);
                    if (newdiff < diff) {
                        diff = newdiff;
                        curr = arr[val];
                    }
                }
                return curr;
            }
function calc(){
	var dis = Number(document.cal.dis.value);
	var hi = parseFloat(document.cal.hi.value);
	var windpo = Number(document.cal.windp.value);
	var wind = Number(document.cal.wind.value);
	var angwind = Number(document.cal.angw.value);

	var sinwind = Math.sin((angwind*3.14)/180);
	var coswind = Math.cos((angwind*3.14)/180);

	var hwi256 = [4.281,4.237,4.194,4.151,4.108
			,4.066,4.024,3.982,3.941,3.900
			,3.859,3.818,3.778,3.738,3.699
			,3.659,3.620,3.582,3.543,3.505
			,3.467,3.430,3.392,3.355,3.319
			,3.282,3.246,3.210,3.175,3.140
			,3.105,3.070,3.035,3.001,2.967
			,2.934,2.900,2.868,2.837,2.805
			,2.774,2.743,2.713,2.682,2.652
			,2.622,2.593,2.563,2.534,2.505
			,2.476,2.448,2.419,2.391,2.363
			,2.336,2.308,2.281,2.254,2.228
			,2.201,2.175,2.149,2.123,2.097
			,2.072,2.047,2.022,1.997,1.972
			,1.948,1.924,1.900];

	var dishwi256 = [225.75,224.83,223.92,223.00,222.08
			,221.17,220.25,219.33,218.42,217.50
			,216.58,215.67,214.75,213.83,212.92
			,212.00,211.08,210.17,209.25,208.33
			,207.42,206.50,205.58,204.67,203.75
			,202.83,201.92,201.00,200.08,199.17
			,198.25,197.33,196.42,195.50,194.58
			,193.67,192.75,191.87,190.99,190.10
			,189.22,188.34,187.46,186.58,185.69
			,184.81,183.93,183.05,182.17,181.28
			,180.40,179.52,178.64,177.76,176.88
			,175.99,175.11,174.23,173.35,172.47
			,171.58,170.70,169.82,168.94,168.06
			,167.17,166.29,165.41,164.53,163.65
			,162.76,161.88,161.00];

	var ele = [0.50,1.00,1.50,2.00,2.50
			,3.00,3.50,4.00,4.50,5.00
			,5.50,6.00,6.50,7.00,7.50
			,8.00,8.50,9.00,9.50,10.00
			,10.50,11.00,11.50,12.00,12.50
			,13.00,13.50,14.00,14.50,15.00
			,15.50,16.00,16.50,17.00,17.50
			,18.00,18.50,19.00,19.50,20.00
			,20.50,21.00,21.50,22.00,22.50
			,23.00,23.50,24.00];

	var adj = [0.01,0.01,0.02,0.03,0.03
			,0.04,0.05,0.05,0.06,0.07
			,0.07,0.08,0.09,0.10,0.10
			,0.11,0.12,0.12,0.13,0.13
			,0.14,0.15,0.16,0.16,0.17
			,0.18,0.18,0.19,0.20,0.20
			,0.21,0.22,0.22,0.23,0.24
			,0.24,0.25,0.26,0.26,0.27
			,0.28,0.29,0.30,0.30,0.31
			,0.31,0.32,0.33];

	var pinh = [247.3,246.3,245.3,244.3,243.3
			,242.3,241.3,240.3,239.3,238.3
			,237.3,236.3,235.3,234.3,233.8
			,233.3,232.8,232.3,231.8,231.3
			,230.8,230.3,229.8,229.3,228.8
			,228.3,227.8,227.3,226.8,226.3
			,225.8,225.3,224.8,224.3,223.8
			,223.3,222.8,222.3,221.8,221.3
			,220.8,220.3,219.8,219.3,218.8
			,218.3,217.8,217.3,216.8,216.3
			,215.8,215.3,214.8,214.3,213.8
			,213.3,212.8,212.3,211.8,211.3
			,210.8,210.3,209.8,209.3,208.8
			,208.3,207.8,207.3,206.8,206.3
			,205.8,205.3,204.8,204.3,203.8
			,203.3,202.8,202.3,201.8,201.3
			,200.8,200.3,199.8,199.3,198.8
			,198.3,197.8,197.3,196.8,196.3
			,195.8,195.3,194.8,194.3,193.8
			,193.3,192.8,192.3,191.8,191.3
			,190.8,190.3,189.8,189.3,188.8
			,188.3,187.8,187.3,186.8,186.3
			,185.8,185.3,184.8,184.3,183.8
			,183.3,182.8,182.3,181.8,181.3
			,180.8,180.3,179.8,179.3,178.8
			,178.3,177.8,177.3,176.8,176.3
			,175.8,175.3,174.8,174.3,173.8
			,173.3,172.8,172.3,171.8,171.3
			,170.8,170.3,169.8,169.3,168.8
			,168.3,167.8,167.3,166.8,166.3
			,165.8,165.3,164.8,164.3,163.8
			,163.3,162.8,162.3,161.8,161.3
			,160.8,160.3,159.8,159.3,158.8
			,158.3,157.8,157.3,156.8,156.3
			,155.8,155.3,154.8,154.3];

	var hl = [0.61,0.62,0.63,0.63,0.64
			,0.65,0.66,0.67,0.67,0.68
			,0.69,0.70,0.71,0.72,0.72
			,0.73,0.73,0.73,0.74,0.74
			,0.75,0.75,0.76,0.76,0.77
			,0.77,0.78,0.78,0.78,0.79
			,0.79,0.80,0.80,0.81,0.81
			,0.82,0.82,0.83,0.83,0.84
			,0.84,0.85,0.86,0.86,0.87
			,0.87,0.88,0.88,0.89,0.89
			,0.90,0.90,0.91,0.91,0.92
			,0.93,0.93,0.94,0.94,0.95
			,0.95,0.96,0.97,0.97,0.98
			,0.98,0.99,1.00,1.00,1.01
			,1.01,1.02,1.03,1.03,1.04
			,1.05,1.05,1.06,1.07,1.07
			,1.08,1.09,1.09,1.10,1.11
			,1.11,1.12,1.13,1.13,1.14
			,1.15,1.15,1.16,1.17,1.18
			,1.18,1.19,1.20,1.20,1.21
			,1.22,1.23,1.23,1.24,1.25
			,1.26,1.26,1.27,1.28,1.29
			,1.30,1.30,1.31,1.32,1.33
			,1.34,1.34,1.35,1.36,1.37
			,1.38,1.39,1.39,1.40,1.41
			,1.42,1.43,1.44,1.45,1.46
			,1.46,1.47,1.48,1.49,1.50
			,1.51,1.52,1.53,1.54,1.55
			,1.56,1.57,1.58,1.59,1.60
			,1.60,1.61,1.62,1.63,1.64
			,1.65,1.66,1.68,1.69,1.70
			,1.71,1.72,1.73,1.74,1.75
			,1.76,1.77,1.78,1.79,1.80
			,1.81,1.82,1.84,1.85,1.86
			,1.87,1.88,1.89,1.90];

	var hp = [0.68,0.69,0.70,0.71,0.72
			,0.73,0.74,0.75,0.76,0.77
			,0.78,0.79,0.80,0.81,0.81
			,0.82,0.83,0.83,0.84,0.84
			,0.85,0.85,0.86,0.86,0.87
			,0.87,0.88,0.89,0.89,0.90
			,0.90,0.91,0.92,0.92,0.93
			,0.93,0.94,0.95,0.95,0.96
			,0.96,0.97,0.98,0.98,0.99
			,1.00,1.00,1.01,1.01,1.02
			,1.03,1.03,1.04,1.05,1.05
			,1.06,1.07,1.08,1.08,1.09
			,1.10,1.10,1.11,1.12,1.13
			,1.13,1.14,1.15,1.15,1.16
			,1.17,1.18,1.18,1.19,1.20
			,1.21,1.22,1.22,1.23,1.24
			,1.25,1.26,1.26,1.27,1.28
			,1.29,1.30,1.31,1.31,1.32
			,1.33,1.34,1.35,1.36,1.37
			,1.37,1.38,1.39,1.40,1.41
			,1.42,1.43,1.44,1.45,1.46
			,1.47,1.48,1.49,1.50,1.50
			,1.51,1.52,1.53,1.54,1.55
			,1.56,1.57,1.58,1.59,1.61
			,1.62,1.63,1.64,1.65,1.66
			,1.67,1.68,1.69,1.70,1.71
			,1.72,1.73,1.75,1.76,1.77
			,1.78,1.79,1.80,1.81,1.83
			,1.84,1.85,1.86,1.87,1.89
			,1.90,1.91,1.92,1.94,1.95
			,1.96,1.97,1.99,2.00,2.01
			,2.03,2.04,2.05,2.06,2.08
			,2.09,2.11,2.12,2.13,2.15
			,2.16,2.17,2.19,2.20,2.22
			,2.23,2.25,2.26,2.27];

	var power = [256,255.9,255.1,254,253
			,252.9,252.1,251,250.9,250.1
			,249,248,247.9,247.1,246
			,245.9,245.1,244,243,242.9
			,242.1,241,240.9,240.1,239
			,238.9,238.1,237,236,235.9
			,235.1,234,233.9,233.1,232
			,231,230.9,230.1,229,228.9
			,228.1,227,226,225.9,225.1
			,224,223.9,223.1,222,221
			,220.9,220.1,219,218.9,218.1
			,217,216,215.9,215.1,214
			,213.9,213.1,212,211,210.9
			,210.1,209,208.9,208.1,207
			,206.9,206.1,205];

	if (windpo==1||windpo==3){
		document.cal.pcell.value="Move Left";
	}
	else if (windpo==2||windpo==4){
		document.cal.pcell.value="Move Right";
	}

	if(windpo ==1 || windpo ==2){
		var cons = 0.23;
	}
	else if(windpo==3||windpo==4){
		var cons = 0.25;
	}
	var n = closest(dis,dishwi256);
	var pos = dishwi256.indexOf(n);
	var inhwi = hwi256[pos];
	var length = inhwi*cons*wind*coswind;

	if(windpo ==1 || windpo ==2){
		var reallength = dis - length;
	}
	else if(windpo==3||windpo==4){
		var reallength = dis + length;
	}

	var n = closest(reallength,dishwi256);
	var pos = dishwi256.indexOf(n);

	var vhwi = hwi256[pos];
	var elee = closest(Math.abs(hi),ele);
	var pele = ele.indexOf(elee);
	var addj = adj[pele];

	if(hi<0){
		var realhwi = vhwi+addj;
	}
	else if(hi>=0){
		var realhwi = vhwi-addj;
	}
	var Line = realhwi*sinwind*wind;
	document.cal.cellpb.value=Line;

	if(hi<0){
		var pph = pinh.indexOf(closest(reallength,pinh));
		var lforce = reallength-(hl[pph]*Math.abs(hi));
	}
	else if(hi>=0){
		var pph = pinh.indexOf(closest(reallength,pinh));
		var lforce = reallength+(hp[pph]*Math.abs(hi));
	}
	var i = dishwi256.indexOf(closest(lforce,dishwi256));
	var force = power[i];
	console.log(force);
	document.cal.power.value=force;

}
